<!DOCTYPE html>
<!--[if IE 8]><html class="ie ie8"> <![endif]-->
<!--[if IE 9]><html class="ie ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>私享网</title>
<link href="css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="css/mystyle.css">
<link rel="stylesheet" href="css/jquery.toastmessage.css">
<!--[if lt IE 9]>
    <script src="js/html5shiv.min.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
</head>
<body class="reset-box-sizing">
	<div class="warp">
		<div class="header" style="display: none" id="header"></div>
        <div class="header">
            <div class="container top-bar">
                <div class="logo pull-left">
                    <a href="/enjoyPrivate"><img alt="" src="images/logo.png"></a>
                </div>
                <div class="serch-bar pull-right" id="topMenu">
            <ul class="bar-list">
                <li><a class="notice" href="javascript:">设为首页</a></li>
                <li><a href="shopping-cart.html"><img alt="" src="images/icon-01.png">购物车<em id="carCount">1</em></a></li>
                <li><a href="order-list.html"><img alt="" src="images/icon-02.png">我的订单<em id="orderCount">14</em></a></li>
                <li class="sub">
                    <img alt="" src="images/icon-03.png">我的消息<em id="newsCount">0</em>
                    <ul>
                        <li><a href="message-01-system.html">系统信息<em>+5</em></a></li>
                        <li><a href="message-02-fans.html">粉丝信息<em>+5</em></a></li>
                        <li><a href="message-03-letters.html">我的私信<em>+5</em></a></li>
                        <li><a href="message-04-share.html">我的转发<em>+5</em></a></li>
                        <li><a href="message-05-comment.html">我的评论<em>+5</em></a></li>
                    </ul>
                </li>
                <li class="sub live">
                    <img alt="" src="images/icon-05.png">账号设置
                    <ul>
                        <li><a href="account-setting-01-security.html">账号安全</a></li>
                        <li><a href="account-setting-02-bind.html">账号绑定</a></li>
                        <li><a href="account-setting-03-privacy.html">隐私设置</a></li>
                        <li><a href="account-setting-04-message.html">消息设置</a></li>
                        <li><a href="account-setting-05-favor.html">偏好设置</a></li>
                        <li><a href="account-setting-06-password.html">修改密码</a></li>
                        <li><a href="login.html">退出</a></li>
                    </ul>
                </li>
                <li><a class="notice" href="homepage-all.html">用户昵称</a></li>
            </ul>
            <div class="serch-btn">
                <input type="text" class="text" value="搜索"><input type="button" class="button">
            </div>
        </div>
            </div>
            <div class="container">
                <div id="mainmenu" class="nav pull-left">
                    <a href="index-in.html" class="">首页</a>
                    <a href="countdown.html" class="cur">倒计时</a>
                    <a href="jingxuan-index.html">精选</a>
                    <a href="yiqi-index.html">一起</a>
                    <a href="star-01-homepage.html">明星</a>
                    <a href="famous-person.html">名人堂</a>
                    <a href="diningroom.html">餐厅</a>
                    <a href="options.html">摄影</a>
                    <a href="options.html">设计</a>
                    <a href="options.html">艺术</a>
                </div>
                <div class="myuser pull-right">
                    <a href="homepage-logined.html"><img alt="" src="images/login-icon.png"> 大笨象的私享</a>
                </div>
            </div>
        </div>
		<div class="container">
			<div class="userinfo-title">
				<div class="ltxt pull-left">账号设置</div>
				<div class="clear"></div>
			</div>
		</div>
		<div class="container">
            <div class="sh-stab">
                <a href="account-setting-01-security.html">账号安全<i></i></a>
                <a class="cur"  href="account-setting-02-bind.html">账号绑定<i></i></a>
                <a href="account-setting-03-privacy.html">隐私设置<i></i></a>
                <a href="account-setting-04-message.html">消息设置<i></i></a>
                <a href="account-setting-05-favor.html">偏好设置<i></i></a>
                <a href="account-setting-06-password.html">修改密码<i></i></a>
                <div class="clear"></div>
            </div>
		</div>
		<div class="container mgb50">
			<div class="account-setting-box">
				<form action="" id="accountForm">
					<ul class="form-list">
						<li><span class="txt">私号</span><span class="txt-notice">00000001</span></li>
						<li><span class="txt">邮箱</span><input type="email"
							class="email" required id="email2" name="email" /> <label
							for="email2"></label></li>
						<li><span class="txt">手机号</span><input type="tel"
							class="mobilephone" required id="mobilephone2" name="mobilephone" />
							<label for="mobilephone"></label></li>
					</ul>
					<span class="confirm-btn" id="btnSaveAccount">保存</span>
				</form>
				<p class="confirm-btn" id="showAddAddressBtn">添加新地址</p>
                <br/>
				<p class="form-title">已保存地址</p>
				<div class="address-list">
					<ul class="added-address-list-title">
						<li class="col1">收货人</li>
						<li class="col2">所在地区</li>
						<li class="col3">详细地址</li>
						<li class="col4">邮编</li>
						<li class="col5">电话/手机</li>
						<li class="col6">操作</li>
					</ul>
					<ul class="added-address-list">
						<li><span class="col1">姓名</span> <span class="col2">四川省成都市金牛区</span>
							<span class="col3">高源大道Xxxx街XXX路1389栋502单元</span> <span
							class="col4">601100</span> <span class="col5">21305200<br>13666666666
						</span> <span class="col6"> <a href="javascript:;">修改</a> | <a
								href="javascript:;">删除</a> <a class="set-default-address"
								href="">设为默认地址</a>
						</span></li>
					</ul>
				</div>

			</div>
		</div>
        <div class="container footer">
            <dl class="list l25 pull-left">
                <dt><em>版权信息</em>Copyright</dt>
                <dd>网站所有版权归圈叉网网络信息平台所有<br>新ICP备 05017822号<br>&copy;2013-2014</dd>
            </dl>
            <dl class="list l38 pull-left">
                <dt><em>联系我们</em>Contact Us</dt>
                <dd>服务热线 010-59788888<br>
                    官网网址 www.ooxx.com<br>
                    电子邮箱 ooxx@ooxx.com(投稿)；ooxx@hotmail.com（商业合作）
                </dd>
            </dl>
            <dl class="list lw200 pull-right">
                <dt><em>网站地图</em>SiteMap</dt>
                <dd>
                    <a href="index-in.html">网站首页</a>
                    <a href="contact.html">联系我们</a>
                    <a href="suggestion.html">投诉建议</a>
                    <a href="javascript:">网站地图</a>
                    <a href="cooperation.html">商业合作</a>
                    <a href="ad.html">广告投放</a>
                    <a href="law.html">法律隐私</a>
                    <a href="about-us.html">关于我们</a>
                </dd>
            </dl>
        </div>
		<div class="copyright container">
			<span class="pull-left">2014-2015&copy; PRESERVE. All rights
				reserved.</span> <span class="pull-right">&copy; 所有版权归圈叉网所有</span>
		</div>
		<div style="display: none" id="footer"></div>
	</div>

	<div class="sh-fifter">
		<div class="buy-fifterin">
			<div class="title">
				<a href="javascript:" class="go-back">返回倒计时</a><a href="javascript:"
					class="close-btn"></a>
			</div>
			<div class="buy-fifterback">
				<div class="sh-title sh-tj-add-title">选择收货地址</div>
				<form id="addressForm">
					<ul class="sh-tjadd-list">
						<input type="hidden" name="id" id="id" />
						<li><em>收货人姓名 <span class="red">*</span></em><input
							type="text" class="text" name="shipping_name" id="shippingname"
							minlength="2" maxlength="4" required></li>
						<li><em>手机号码 <span class="red">*</span></em><input
							type="text" class="text mobilephone" name="phone" id="phone"
							length="11" required></li>
						<li><em>电话号码</em><input type="text" class="text telephone"
							name="telephone" id="telephone"></li>
						<li><em>所在地区 <span class="red">*</span></em><select
							class="s selectNone" name="province_name" id="s1" required></select><select
							class="s selectNone" name="city_name" id="s2"></select><select
							class="s selectNone" name="regions_name" id="s3"></select></li>
						<li><em>地址 <span class="red">*</span></em> <textarea
								class="text" name="address" id="address" maxlength="80" required></textarea></li>
						<li><em>电子邮箱 <span class="red">*</span></em><input
							type="text" class="text email" name="email" id="email" required></li>
						<li><em>邮政编码</em><input type="text" class="text postcode"
							name="zipo" id="zipo"></li>
						<li><label> <input type="checkbox" value="0"
								id="isDefault" name="isDefault"> 设置为默认收货地址
						</label></li>
						<li><input type="submit" value="保存" class="add-submit"
							id="btnAddAddress"></li>
					</ul>
				</form>
			</div>
		</div>
	</div>
	<script src="js/jquery-1.11.3.min.js"></script>
	<script src="js/jquery.form.js"></script>
	<script src="js/jsAddress.js"></script>
	<script src="js/jquery.validate.js"></script>
	<script src="js/messages_zh.js"></script>
	<script src="js/common.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script>
		//加载地址
		function loadAddress() {
			doAjax(
					"${ctx}/blogic/memberAddress/listMemberAddress",
					"",
					function(data) {
						if (data.status == 1) {
							var addresss = data.data;
							var count = addresss.length;
							if (count == 0) {
								return;
							} else {
								var obj = $("#addressList");
								obj.html("");
								for (var i = 0; i < addresss.length; i++) {
									var appendData = "";
									var isDefault = addresss[i].isDefault;
									if (isDefault == 1) {
										isDefault = 'checked="checked" value="1"';
									} else {
										isDefault = 'value="0"';
									}
									appendData = ' <li>'
											+ ' <span class="w1"><input addressId="'+addresss[i].id+'" type="checkbox" '+isDefault+'></span>'
											+ ' <span class="w2">'
											+ addresss[i].shipping_name
											+ '</span>'
											+ ' <span class="w3"><span class="provincename">'
											+ addresss[i].province_name
											+ '</span> <span class="cityname">'
											+ addresss[i].city_name
											+ ' </span><span class="regionsname">'
											+ addresss[i].regions_name
											+ '</span></span>'
											+ ' <span class="w4">'
											+ addresss[i].address
											+ '</span>'
											+ ' <span class="w5">'
											+ addresss[i].zipo
											+ '</span>'
											+ ' <span class="w6">'
											+ addresss[i].phone
											+ '</span>'
											+ ' <span class="w7">修改</span>'
											+ '<span class="email" style="display:none;">'
											+ addresss[i].email
											+ '</span>'
											+ ' <span class="id" style="display:none;">'
											+ addresss[i].id
											+ '</span>'
											+ '<span class="telephone" style="display:none;">'
											+ addresss[i].telephone
											+ '</span>'
											+ ' </li>';
									obj.append(appendData);
								}

							}
						} else if (data.status == 0) {
							alertInfo(data.message, true);
						}
					}, function(data, status) {
						alertError("服务器异常", true);
					});
		}

		$(function() {

			//省市区初始化
			addressInit('s1', 's2', 's3');

			//修改地址
			$("#addressList")
					.on(
							"click",
							"li .w7",
							function() {
								var addObj = $(this).parent();
								var isDefault = addObj.find(".w1 input").val();
								var shippingname = addObj.find(".w2").html();
								var telephone = addObj.find(".telephone")
										.html();
								var provincename = addObj.find(".provincename")
										.html();
								var cityname = addObj.find(".cityname").html();
								var regionsname = addObj.find(".regionsname")
										.html();
								var address = addObj.find(".w4").html();
								var zipo = addObj.find(".w5").html();
								var phone = addObj.find(".w6").html();
								var email = addObj.find(".email").html();
								var id = addObj.find(".id").html();
								addAddressOptions.url = '${ctx}/blogic/memberAddress/updateMemberAddress';
								$("#id").val(id);
								$("#isDefault").val(isDefault);
								if (isDefault == 1) {
									$("#isDefault").attr("checked", 'checked');
								} else {
									$("#isDefault").removeAttr("checked");
								}

								$("#shippingname").val(shippingname);
								$("#phone").val(phone);
								addressInit('s1', 's2', 's3', provincename,
										cityname, regionsname);
								$("#address").val(address);
								$("#telephone").val(telephone);
								$("#email").val(email);

								$(".sh-fifter").show();
								$(".buy-fifterin-s").hide();
							});

			var addAddressOptions = {
				type : 'post',
				dataType : 'json',
				url : '${ctx}/blogic/memberAddress/saveMemberAddress',
				success : function(data, statusText) {

					if (data.status == 1) {
						alertInfo("操作成功！");
						loadAddress();
						$(".sh-fifter").hide();
						$(".buy-fifterin-s").show();
					} else if (data.status == 0) {
						alertInfo(data.message)
					}
				},
				error : function(data, status) {
					alert("服务器异常");
				}
			};

			var accountOptions = {
				type : 'post',
				dataType : 'json',
				url : '${ctx}/blogic/memberAddress/saveMemberAddress',
				success : function(data, statusText) {

					if (data.status == 1) {
						alertInfo("保存成功！");
						$(".sh-fifter").hide();
						$(".buy-fifterin-s").show();
					} else if (data.status == 0) {
						alertInfo(data.message)
					}
				},
				error : function(data, status) {
					alert("服务器异常");
				}
			};

			//保存账号验证
			$("#accountForm").validate({
				submitHandler : function(form) {
					$(form).ajaxSubmit(addAddressOptions);
				}
			});

			//添加地址验证
			$("#addressForm").validate({
				submitHandler : function(form) {
					$(form).ajaxSubmit(addAddressOptions);
				}
			});

			//添加地址
			$("#btnAddAddress").click(function() {
				$("#addressForm").submit();
			});

			//保存账号
			$("#btnSaveAccount").click(function() {
				$("#accountForm").submit();
			});

			//提交订单按钮
			$("#submitOrder").click(function() {
				submitOrder();
			});

			//新增地址按钮
			$("#showAddAddressBtn")
					.click(
							function() {
								addAddressOptions.url = '${ctx}/blogic/memberAddress/saveMemberAddress';

								$("#id").val("");
								$("#isDefault").val(0);
								$("#shippingname").val("");
								$("#phone").val("");
								addressInit('s1', 's2', 's3');
								$("#address").val("");
								$("#telephone").val("");
								$("#email").val("");
								$("#zipo").val("");
                                $(".sh-fifter").height($(document).height());
								$(".sh-fifter").show();

								$(".buy-fifterin-s").hide();
							});
			//关闭新增地址弹窗
			$(".buy-fifterin a.go-back,.buy-fifterin a.close-btn").click(
					function() {
						$(".sh-fifter").hide();
						$(".buy-fifterin-s").show();
					})
		})
	</script>
</body>
</html>